<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 520 620" font-family="sans-serif">
  <defs>
    <marker id="a" markerWidth="10" markerHeight="8" refX="6" refY="4" orient="auto" markerUnits="userSpaceOnUse">
      <path d="M0,0 L10,4 L0,8 Z" fill="#aaa"/>
    </marker>
  </defs>

  <!-- Input -->
  <rect x="170" y="10" width="180" height="40" rx="10" fill="#8b5cf6"/>
  <text x="260" y="35" text-anchor="middle" fill="#fff" font-size="13" font-weight="bold">Input Tokens</text>

  <!-- Arrow -->
  <line x1="260" y1="58" x2="260" y2="78" stroke="#aaa" stroke-width="2" marker-end="url(#a)"/>

  <!-- Embedding -->
  <rect x="150" y="86" width="220" height="40" rx="10" fill="#8b5cf6"/>
  <text x="260" y="107" text-anchor="middle" fill="#fff" font-size="13">Embedding + Positional Encoding</text>
  <text x="260" y="121" text-anchor="middle" fill="#ddd" font-size="10">each token → number vector + position</text>

  <!-- Arrow -->
  <line x1="260" y1="134" x2="260" y2="154" stroke="#aaa" stroke-width="2" marker-end="url(#a)"/>

  <!-- Transformer Block (repeated N times) -->
  <rect x="40" y="162" width="440" height="340" rx="14" fill="none" stroke="#4a9eff" stroke-width="2" stroke-dasharray="8,4"/>
  <text x="470" y="180" text-anchor="end" fill="#4a9eff" font-size="12" font-weight="bold">× N layers</text>

  <!-- Multi-Head Attention -->
  <rect x="110" y="182" width="300" height="50" rx="10" fill="#4a9eff"/>
  <text x="260" y="203" text-anchor="middle" fill="#fff" font-size="14" font-weight="bold">Multi-Head Attention</text>
  <text x="260" y="222" text-anchor="middle" fill="#ddd" font-size="10">each word scans all others, collecting clues</text>

  <!-- Arrow + Add&Norm 1 -->
  <line x1="260" y1="240" x2="260" y2="256" stroke="#aaa" stroke-width="2" marker-end="url(#a)"/>

  <!-- Residual arrow (left side) going from before attention to after Add&Norm -->
  <line x1="90" y1="155" x2="90" y2="280" stroke="#5dbe8a" stroke-width="2" stroke-dasharray="4,3"/>
  <line x1="90" y1="280" x2="108" y2="280" stroke="#5dbe8a" stroke-width="2" marker-end="url(#a)"/>

  <rect x="116" y="264" width="288" height="34" rx="8" fill="#5dbe8a"/>
  <text x="260" y="286" text-anchor="middle" fill="#fff" font-size="12" font-weight="bold">Residual Connection + Layer Norm</text>

  <!-- Arrow -->
  <line x1="260" y1="306" x2="260" y2="322" stroke="#aaa" stroke-width="2" marker-end="url(#a)"/>

  <!-- Feed-Forward Network -->
  <rect x="110" y="330" width="300" height="50" rx="10" fill="#4a9eff"/>
  <text x="260" y="351" text-anchor="middle" fill="#fff" font-size="14" font-weight="bold">Feed-Forward Network</text>
  <text x="260" y="370" text-anchor="middle" fill="#ddd" font-size="10">each word independently "thinks", updating its understanding</text>

  <!-- Arrow + Add&Norm 2 -->
  <line x1="260" y1="388" x2="260" y2="404" stroke="#aaa" stroke-width="2" marker-end="url(#a)"/>

  <!-- Residual arrow (left side) for FFN -->
  <line x1="90" y1="300" x2="90" y2="428" stroke="#5dbe8a" stroke-width="2" stroke-dasharray="4,3"/>
  <line x1="90" y1="428" x2="108" y2="428" stroke="#5dbe8a" stroke-width="2" marker-end="url(#a)"/>

  <rect x="116" y="412" width="288" height="34" rx="8" fill="#5dbe8a"/>
  <text x="260" y="434" text-anchor="middle" fill="#fff" font-size="12" font-weight="bold">Residual Connection + Layer Norm</text>

  <!-- End of block bracket -->
  <!-- Arrow to output -->
  <line x1="260" y1="510" x2="260" y2="530" stroke="#aaa" stroke-width="2" marker-end="url(#a)"/>

  <!-- Output -->
  <rect x="150" y="538" width="220" height="40" rx="10" fill="#e85d5d"/>
  <text x="260" y="559" text-anchor="middle" fill="#fff" font-size="13" font-weight="bold">Output Layer</text>
  <text x="260" y="573" text-anchor="middle" fill="#ddd" font-size="10">predict probability of next token</text>

  <!-- Legend -->
  <rect x="80" y="595" width="12" height="12" rx="2" fill="#8b5cf6"/>
  <text x="98" y="606" fill="#aaa" font-size="10">Data</text>
  <rect x="150" y="595" width="12" height="12" rx="2" fill="#4a9eff"/>
  <text x="168" y="606" fill="#aaa" font-size="10">Computation</text>
  <rect x="260" y="595" width="12" height="12" rx="2" fill="#5dbe8a"/>
  <text x="278" y="606" fill="#aaa" font-size="10">Residual + Norm</text>
  <rect x="380" y="595" width="12" height="12" rx="2" fill="#e85d5d"/>
  <text x="398" y="606" fill="#aaa" font-size="10">Output</text>
</svg>
