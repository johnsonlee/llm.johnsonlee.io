<!-- .slide: class="center" -->

## 11. 代码生成

*AI 能写程序吗？*

----

## 代码有什么特别的？

写代码跟写文章不太一样：

- 必须 **分毫不差** ——少一个字符程序就跑不起来
- 必须有 **正确的逻辑** ——程序得真能干你想让它干的事
- 可以 **直接验证** ——跑一下就知道对不对

> 一个靠“猜下一个词”训练出来的大语言模型，真能写出能跑的代码吗？

----

## StarCoder：开源的代码模型

第一步：收集一座代码大山——一个叫 **The Stack** 的数据集：

- 从 GitHub 上采集了 86 种以上编程语言的代码
- 经过去重和质量过滤
- 在此基础上训练了一个 150 亿参数的代码专用大语言模型

> [StarCoder](https://arxiv.org/abs/2305.06161)（2023）— 人人可用的开源代码生成大语言模型

----

## 代码数据为什么特别

用代码来训练，能让大语言模型学到纯文本教不了的东西：

- **逻辑推理** ：代码必须逻辑正确，否则跑不起来
- **结构化思维** ：函数、循环、条件语句教会大语言模型一步步规划
- **精确性** ：差一个字符程序就崩——没有“差不多”一说

研究发现，用代码训练过的大语言模型在数学和推理任务上也会变强，即便是非编程任务！

----

## DeepSeek-Coder：看懂整个项目

大多数代码模型只能处理 **单个文件** ，但真正的项目往往有几十上百个文件！

- 在 **仓库级别** 的代码上训练，学会理解文件之间的依赖关系
- 不光能续写代码，还能 **补全中间的空缺**
- 就像能读懂一整本书，而不只是看懂一页

> [DeepSeek-Coder](https://arxiv.org/abs/2401.14196)（2024）— 仓库级代码理解能力

----

## AlphaCode：跟人类同台竞技

AI 能不能解 **编程比赛** 里那种超级难的题？连很多大人程序员都觉得棘手：

- 读懂复杂的题目描述
- 构思出合适的算法
- 在各种约束条件下写出正确代码

AlphaCode 的绝招：先生成 **几百万个** 候选解，再过滤筛选、聚类去重。

> [AlphaCode](https://arxiv.org/abs/2203.07814)（2022）— 达到竞赛水平的代码生成

----

## AlphaCode 的秘诀：大量生成、严格筛选

普通人写一个方案然后慢慢调试。AlphaCode 的做法完全不同：

1. 先生成 **100 万个** 候选方案
2. 用测试用例逐一验证
3. 把相似的方案聚成一类
4. 每类里选一个最好的提交

就像头脑风暴出一百万个点子，然后逐个测试。只有最优解才能留下——这种“大力出奇迹”的策略效果出奇地好！

----

## Flow Engineering：写完跑一下、不对就改

如果 AI 不是匆匆写完代码就交卷，而是像真正的程序员一样 **反复迭代** 呢？

1. 先读需求，生成初版代码
2. 跑一下 **测试** ——通过了吗？
3. 没通过就看报错信息，修改代码
4. 循环往复，直到所有测试通过

这种测试驱动的迭代方式，效果远超“一次性生成”。

> [Flow Engineering](https://arxiv.org/abs/2401.08500)（2024）— 测试驱动的迭代式代码生成

----

## 人类程序员 vs AI 写代码

| 步骤 | 人类开发者 | 用了 Flow Engineering 的 AI |
|------|-----------|----------------------------|
| 1 | 读需求 | 读需求 |
| 2 | 想方案 | 生成初版代码 |
| 3 | 写代码 | 跑测试 |
| 4 | 跑测试 | 看报错，修代码 |
| 5 | 调试修复 | 再跑测试 |
| 6 | 反复直到搞定 | 反复直到全部通过 |

关键发现：当 AI 能 **看到自己的错误** 并反复尝试时，写代码的能力会突飞猛进——跟人类一个道理！

----

## 第 11 章总结

| 论文 | 核心思想 |
|------|----------|
| [StarCoder](https://arxiv.org/abs/2305.06161)（2023） | 基于 The Stack 数据集的开源代码模型 |
| [DeepSeek-Coder](https://arxiv.org/abs/2401.14196)（2024） | 仓库级代码理解 |
| [AlphaCode](https://arxiv.org/abs/2203.07814)（2022） | 海量生成 + 筛选，达到竞赛水平 |
| [Qwen2.5-Coder](https://arxiv.org/abs/2409.12186)（2024） | 多语言代码补全与修复 |
| [Flow Engineering](https://arxiv.org/abs/2401.08500)（2024） | 测试驱动的迭代生成 |

----

## 想深入了解？

- [The Stack (Hugging Face)](https://huggingface.co/datasets/bigcode/the-stack) — 探索 StarCoder 背后的超大代码数据集
- [AlphaCode Explained (Two Minute Papers)](https://www.youtube.com/watch?v=t3Yh56efKGI) — 两分钟快速了解 AlphaCode（视频）
- [GitHub Copilot](https://github.com/features/copilot) — 亲自体验 AI 辅助编程
- [SWE-bench: Can AI Fix Real Bugs?](https://www.swebench.com/) — 编程智能体排行榜

----

## 想一想

- 代码必须精确无误，但自然语言是模糊的。一个在“模糊”文本上训练的大语言模型是怎么学会写“精确”代码的？
- AlphaCode 生成一百万个方案然后选最好的。这算是“有创造力”还是“把所有可能都试一遍”？两者有什么区别？
- 如果 AI 都能写代码了，你还需要学编程吗？哪些技能会变得更重要，哪些会变得不那么重要？
- Flow Engineering 让 AI 通过阅读报错信息来调试自己的代码。还有什么技能可以通过“对自己的工作获得反馈”来学会？
